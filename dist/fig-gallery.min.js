"use strict";function FigureGallery(e){var t=this,n=e.container,i=void 0===n?"#gallery":n,r=e.gallerySelector,o=void 0===r?".gallery":r,a=e.openSelector,l=void 0===a?".open":a,s=e.currentSelector,c=void 0===s?".current":s,u=e.buttonContainerSelector,d=void 0===u?null:u,v=e.buttonSelectors,h=void 0===v?{}:v,p=e.buttonContents,g=void 0===p?{}:p,f=e.cycle,m=void 0===f||f,E=e.overlaySelectors,w=void 0===E?{}:E,y=e.openable,C=void 0===y||y,b=e.throwsOpenIndexError,L=void 0!==b&&b,O=e.resizePolicy,S=void 0===O?"CONTENT":O,T=e.buttonPlacementPolicy,F=void 0===T?"ALL":T;if("string"==typeof i&&(i=document.querySelector(i)),!(i instanceof HTMLElement))throw new Error("The gallery container must be a valid DOM element.");if(null!==d&&["ALL","NAVIGATORS_ONLY","CLOSE_ONLY"].indexOf(F)<=-1)throw new Error("The specified button placement policy is not defined.");if(["CONTENT","CONTAINER"].indexOf(S)<=-1)throw new Error("The specified resize policy is not defined.");var N=this;h=Object.assign({close:".close",prev:".prev",next:".next"},h),g=Object.assign({close:"&times;",prev:"&lang;",next:"&rang;"},g),w=Object.assign({overlay:".overlay",content:".overlay-content"},w);var x=o.substr(1),I=l.substr(1),A=c.substr(1),k={close:h.close.substr(1),prev:h.prev.substr(1),next:h.next.substr(1)},M={overlay:w.overlay.substr(1),content:w.content.substr(1)};i.classList.contains(x)||i.classList.add(x);var H=i.querySelectorAll("figure"),R=function(){var e=i.querySelector(w.overlay),t=function(){if(null===d)return null;var t=e.querySelector(d);if(!t)throw new Error("'".concat(d,"' must be child of '").concat(w.overlay,"'."));return t}();for(var n in e||((e=document.createElement("HTMLDialogElement"in window?"dialog":"div")).classList.add(M.overlay),e.content=document.createElement("div"),e.content.classList.add(M.content),e.appendChild(e.content),i.appendChild(e)),e.buttons={},h){var r=e.querySelector(h[n]);r||((r=document.createElement("button")).classList.add(k[n]),r.innerHTML=g[n],null===t?e.appendChild(r):"ALL"===F.toUpperCase()?t.appendChild(r):"NAVIGATORS_ONLY"===F.toUpperCase()?"close"!==n?t.appendChild(r):e.appendChild(r):"CLOSE_ONLY"===F.toUpperCase()&&("close"===n?t.appendChild(r):e.appendChild(r))),e.buttons[n]=r}return e.getContent=function(){return e.content.querySelector("img, video, object, embed, iframe")},e}(),z=function(){var e=!0,t=!1,n=void 0;try{for(var i,r=H[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;if(o.classList.contains(A))return o}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}return H[0]||null}(),U="function"==typeof SwipeEvent?new SwipeEvent({element:i,itemSelector:"figure",activeSelector:c}):null,B=function containerClick(e){N.isOpen()||N.open(null)},D=function figureClick(e){e.stopImmediatePropagation();for(var t=e.target;"FIGURE"!==t.tagName;)t=t.parentNode;N.set(t).open(null)},q=function keyboardNavigation(e){if(N.isOpen())switch(e.which||e.keyCode||0){case 27:N.close();break;case 37:N.prev();break;case 39:N.next();break;case 36:N.open(0);break;case 35:N.open(-1)}},W=function swipeNavigation(e){var t=e.detail.direction||e.direction||null;"left"===t?N.prev():"right"===t&&N.next()},P=function resize(){setContentSize()};function keepInBound(e){return((arguments.length>1&&void 0!==arguments[1]?arguments[1]:m)&&e<0?H.length+e+H.length:e)%H.length}function setContentSize(){if(R){var e=R.getContent();if(e)switch(e.tagName){case"IMG":!function setImageSize(e){if(R){var t=R.content.currentStyle||window.getComputedStyle(R.content),n=Math.min(1,(R.clientWidth-(parseFloat(t.marginLeft)+parseFloat(t.marginRight)))/e.naturalWidth,(R.clientHeight-(parseFloat(t.marginTop)+parseFloat(t.marginBottom)))/e.naturalHeight);"CONTENT"===S.toUpperCase()?(e.style.width=e.naturalWidth*n+"px",e.style.height=e.naturalHeight*n+"px"):"CONTAINER"===S.toUpperCase()&&(R.content.style.width=e.naturalWidth*n+"px",R.content.style.height=e.naturalHeight*n+"px")}}(e);break;case"VIDEO":!function setVideoSize(e){if(R){var t=R.content.currentStyle||window.getComputedStyle(R.content),n=Math.min(1,(R.clientWidth-(parseFloat(t.marginLeft)+parseFloat(t.marginRight)))/e.videoWidth,(R.clientHeight-(parseFloat(t.marginTop)+parseFloat(t.marginBottom)))/e.videoHeight);"CONTENT"===S.toUpperCase()?(e.style.width=e.videoWidth*n+"px",e.style.height=e.videoHeight*n+"px"):"CONTAINER"===S.toUpperCase()&&(R.content.style.width=e.videoWidth*n+"px",R.content.style.height=e.videoHeight*n+"px")}}(e);break;case"EMBED":case"IFRAME":case"OBJECT":!function setEmbedSize(e){if(R){var t=R.content.currentStyle||window.getComputedStyle(R.content);(!e.hasAttribute("data-width")||!e.hasAttribute("data-height")||e.width>parseInt(e.getAttribute("data-width"))||e.height>parseInt(e.getAttribute("data-height")))&&(e.setAttribute("data-width",e.width),e.setAttribute("data-height",e.height)),e.width=parseInt(e.getAttribute("data-width")),e.height=parseInt(e.getAttribute("data-height"));var n=Math.min((R.clientWidth-(parseFloat(t.marginLeft)+parseFloat(t.marginRight)))/e.width,(R.clientHeight-(parseFloat(t.marginTop)+parseFloat(t.marginBottom)))/e.height);"CONTENT"===S.toUpperCase()?(e.width=parseInt(e.width*n),e.height=parseInt(e.height*n)):"CONTAINER"===S.toUpperCase()&&(R.content.style.width=e.width*n+"px",R.content.style.height=e.height*n+"px")}}(e)}}}function getFigureIndex(e){return Array.prototype.indexOf.call(H,e)}function setCurrentFigure(e){null!=z&&z.classList.remove(A),e.classList.add(A),z=e}function updateOverlayFigure(){var e=z.cloneNode(!0);if(i.classList.add(I),R){"HTMLDialogElement"in window&&R instanceof HTMLDialogElement?R.open||R.showModal():R.classList.add(I);var t=R.content.querySelector("figure");t?R.content.replaceChild(e,t):R.content.firstChild?R.content.insertBefore(e,R.content.firstChild):R.content.appendChild(e),setContentSize()}}function navigateOverlayFigure(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;setCurrentFigure(H[keepInBound(getFigureIndex(z)+e,t)]),N.isOpen()&&updateOverlayFigure()}for(var G=function setListenersFn(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return C?(i.addEventListener("click",B,!1),!e&&Y||H.forEach(function(e){e.addEventListener("click",D,!1)}),document.addEventListener("keydown",q),U&&(U.attach(),document.addEventListener("swipe",W)),window.addEventListener("resize",P)):(i.removeEventListener("click",B,!1),H.forEach(function(e){e.removeEventListener("click",D,!1)}),document.removeEventListener("keydown",q),U&&(U.detach(),document.removeEventListener("swipe",W)),window.removeEventListener("resize",P)),setListenersFn}(!0),j=Object.keys(R.buttons),_=function _loop(){var e=j[V];R.buttons[e].addEventListener("click",function(t){t.stopImmediatePropagation(),N[e]()},!1)},V=0;V<j.length;V++)_();var Y=function(){if("MutationObserver"in window){var e=new MutationObserver(function(e,t){e.forEach(function(e){"childList"===e.type&&(H=i.querySelectorAll("figure"),e.addedNodes&&e.addedNodes.length>0&&e.addedNodes.forEach(function(e){"FIGURE"===e.tagName&&e.addEventListener("click",D,!1)}),e.removedNodes&&z in e.removedNodes.values()&&(z=H[0]||null))})});return e.observe(i,{childList:!0}),e}return null}();this.open=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(null==e)e=getFigureIndex(z);else if(e=parseInt(e),L){if(e>H.length-1||Math.abs(e)>H.length-1)throw new Error("The element #".concat(e," cannot be found."))}else e=keepInBound(e);N.isOpen()&&H[e]===z||((H.length>0||e<=H.length||null==z)&&setCurrentFigure(H[0]),null!=z&&updateOverlayFigure());var n=null;return"function"!=typeof window.CustomEvent?(n=document.createEvent("opened")).initCustomEvent("opened",!1,!1,{current:z}):n=new CustomEvent("opened",{detail:{current:z}}),i.dispatchEvent(n),t},this.prev=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,n=z;navigateOverlayFigure(-1,e);var r=null;return"function"!=typeof window.CustomEvent?(r=document.createEvent("prev")).initCustomEvent("prev",!1,!1,{current:z,next:n}):r=new CustomEvent("prev",{detail:{current:z,next:n}}),i.dispatchEvent(r),t},this.next=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,n=z;navigateOverlayFigure(1,e);var r=null;return"function"!=typeof window.CustomEvent?(r=document.createEvent("next")).initCustomEvent("next",!1,!1,{current:z,prev:n}):r=new CustomEvent("next",{detail:{current:z,prev:n}}),i.dispatchEvent(r),t},this.set=function(e){if(!e)throw new Error("The given element is not a valid value. Please, insert an integer or a DOM element.");if("number"==typeof e){if(L){if(e>H.length-1||Math.abs(e)>H.length-1)throw new Error("The element #".concat(e," cannot be found."))}else e=keepInBound(e);e=H[e]}else{if(!(e instanceof HTMLElement))throw new Error("The given element is not a valid value. Please, insert an integer or a DOM element.");if(getFigureIndex(e)<0)throw new Error("The given element is not in this gallery.")}var n=z;setCurrentFigure(e),updateOverlayFigure();var r=null;return"function"!=typeof window.CustomEvent?(r=document.createEvent("setted")).initCustomEvent("setted",!1,!1,{current:z,old:n}):r=new CustomEvent("setted",{detail:{current:z,old:n}}),i.dispatchEvent(r),t},this.close=function(){R&&("HTMLDialogElement"in window&&R instanceof HTMLDialogElement?R.open&&R.close():R.classList.remove(I));var e=null;return"function"!=typeof window.CustomEvent?(e=document.createEvent("closed")).initCustomEvent("closed",!1,!1,{current:z}):e=new CustomEvent("closed",{detail:{current:z}}),i.dispatchEvent(e),t},this.setOpenable=function(e){if("boolean"!=typeof e)throw new Error("The value must be a boolean.");if(e!==C){C=e,Y&&(e?Y.observe(i,{childList:!0}):Y.disconnect()),G();var n=null;"function"!=typeof window.CustomEvent?(n=document.createEvent("openablechange")).initCustomEvent("openablechange",!1,!1,{openable:e}):n=new CustomEvent("openablechange",{detail:{openable:e}}),i.dispatchEvent(n)}return t},this.updateFigures=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return H=i.querySelctorAll("figure"),e&&H.forEach(function(e){e.addEventListener("click",D,!1)}),z in H||(z=H[0]||null),t},this.isOpen=function(){return i.classList.contains(I)},this.isOpenable=function(){return C},this.getContainer=function(){return i},this.getCurrentFigure=function(){return z},this.getActiveFigure=function(){return R.content},this.getActiveContent=function(){return R.getContent()},this.getSwipeHandler=function(){return U}}
//# sourceMappingURL=fig-gallery.js.map
