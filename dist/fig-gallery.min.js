"use strict";function FigureGallery(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.container,i=void 0===n?"#gallery":n,r=t.gallerySelector,o=void 0===r?".gallery":r,a=t.openSelector,l=void 0===a?".open":a,c=t.currentSelector,s=void 0===c?".current":c,u=t.buttonContainerSelector,d=void 0===u?null:u,v=t.buttonSelectors,g=void 0===v?{}:v,h=t.buttonContents,p=void 0===h?{}:h,f=t.buttonsOrder,E=void 0===f?["prev","next","close"]:f,C=t.cycle,m=void 0===C||C,O=t.overlaySelectors,y=void 0===O?{}:O,w=t.swipe,T=void 0!==w&&w,N=t.openable,L=void 0===N||N,b=t.throwsOpenIndexError,I=void 0!==b&&b,S=t.resizePolicy,A=void 0===S?RESIZE_POLICY.CONTENT:S,_=t.buttonPlacementPolicy,k=void 0===_?BUTTON_PLACEMENT_POLICY.ALL:_,P=t.buttonContainerPlacementPolicy,F=void 0===P?BUTTON_CONTAINER_PLACEMENT_POLICY.OUTSIDE_CONTENT:P;if("string"==typeof i&&(i=document.querySelector(i)),!(i instanceof HTMLElement))throw new Error("The gallery container must be a valid DOM element.");if(null!=d){if(!BUTTON_PLACEMENT_POLICY[k])throw new Error("The specified button placement policy is not defined.");if(!BUTTON_CONTAINER_PLACEMENT_POLICY[F])throw new Error("The specified button container placement policy is not defined.")}if(!RESIZE_POLICY[A])throw new Error("The specified resize policy is not defined.");if(3!==E.length||-1===E.indexOf("prev")&&-1===E.indexOf("prev")&&-1===E.indexOf("close"))throw new Error("The given order doesn't include all the buttons.");var x=this;g=Object.assign({close:".close",prev:".prev",next:".next"},g),p=Object.assign({close:"&times;",prev:"&lang;",next:"&rang;"},p),y=Object.assign({overlay:".overlay",content:".overlay-content"},y);var M=o.substr(1),R=l.substr(1),U=s.substr(1),Y={close:g.close.substr(1),prev:g.prev.substr(1),next:g.next.substr(1)},B={overlay:y.overlay.substr(1),content:y.content.substr(1)};i.classList.contains(M)||i.classList.add(M);var z=i.querySelectorAll("figure"),H=null,D=null,W=createOverlay(),j=function(){var e=!0,t=!1,n=void 0;try{for(var i,r=z[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;if(o.classList.contains(U))return o}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}return z[0]||null}(),q=T&&"function"==typeof SwipeEvent?new SwipeEvent({element:i,itemSelector:"figure",activeSelector:s}):null,Z={containerClick:function containerClick(){x.isOpen()||x.open(null)},figureClick:function figureClick(e){e.stopImmediatePropagation();for(var t=e.target;"FIGURE"!==t.tagName;)t=t.parentNode;x.set(t).open(null)},dialogClick:function dialogClick(e){e.stopImmediatePropagation(),e.target.classList.contains(B.overlay)&&x.isOpen()&&x.close()},keyboardNavigation:function keyboardNavigation(e){if(x.isOpen())switch(e.which||e.keyCode||0){case 27:x.close();break;case 37:x.prev();break;case 39:x.next();break;case 36:x.open(0);break;case 35:x.open(-1)}},swipeNavigation:function swipeNavigation(e){var t=e.detail.direction||e.direction||null;"left"===t?x.prev():"right"===t&&x.next()},resize:function resize(){setContentSize()},buttons:createButtonsCallbacks()};function keepInBound(e){return((arguments.length>1&&void 0!==arguments[1]?arguments[1]:m)&&e<0?z.length+e+z.length:e)%z.length}function setContentSize(){if(W){var e=W.getContent();if(e)switch(e.tagName){case"IMG":!function setImageSize(e){function updateImageSize(){var t=W.content.currentStyle||window.getComputedStyle(W.content),n=Math.min(1,(W.clientWidth-(parseFloat(t.marginLeft)+parseFloat(t.marginRight)))/e.naturalWidth,(W.clientHeight-(parseFloat(t.marginTop)+parseFloat(t.marginBottom)))/e.naturalHeight);A.toUpperCase()===RESIZE_POLICY.CONTENT?(e.style.width=(e.naturalWidth||document.body.clientWidth)*n+"px",e.style.height=(e.naturalHeight||document.body.clientHeight)*n+"px"):A.toUpperCase()===RESIZE_POLICY.CONTAINER&&(W.content.style.width=(e.naturalWidth||document.body.clientWidth)*n+"px",W.content.style.height=(e.naturalHeight||document.body.clientHeight)*n+"px")}W&&e&&(e.complete?updateImageSize():e.addEventListener("load",function resizeImage(){updateImageSize(),e.removeEventListener("load",resizeImage)}))}(e);break;case"VIDEO":!function setVideoSize(e){if(W){var t=W.content.currentStyle||window.getComputedStyle(W.content),n=Math.min(1,(W.clientWidth-(parseFloat(t.marginLeft)+parseFloat(t.marginRight)))/e.videoWidth,(W.clientHeight-(parseFloat(t.marginTop)+parseFloat(t.marginBottom)))/e.videoHeight);A.toUpperCase()===RESIZE_POLICY.CONTENT?(e.style.width=e.videoWidth*n+"px",e.style.height=e.videoHeight*n+"px"):A.toUpperCase()===RESIZE_POLICY.CONTAINER&&(W.content.style.width=e.videoWidth*n+"px",W.content.style.height=e.videoHeight*n+"px")}}(e);break;case"EMBED":case"IFRAME":case"OBJECT":!function setEmbedSize(e){if(W){var t=W.content.currentStyle||window.getComputedStyle(W.content);(!e.hasAttribute("data-width")||!e.hasAttribute("data-height")||e.width>parseInt(e.getAttribute("data-width"))||e.height>parseInt(e.getAttribute("data-height")))&&(e.setAttribute("data-width",e.width),e.setAttribute("data-height",e.height)),e.width=parseInt(e.getAttribute("data-width")),e.height=parseInt(e.getAttribute("data-height"));var n=Math.min((W.clientWidth-(parseFloat(t.marginLeft)+parseFloat(t.marginRight)))/e.width,(W.clientHeight-(parseFloat(t.marginTop)+parseFloat(t.marginBottom)))/e.height);A.toUpperCase()===RESIZE_POLICY.CONTAINER&&(W.content.style.width=e.width*n+"px",W.content.style.height=e.height*n+"px"),e.width=parseInt(e.width*n),e.height=parseInt(e.height*n)}}(e)}}}function createOverlay(){if(L){if(H)return i.appendChild(H),H;var e=i.querySelector(y.overlay);e||((e=document.createElement("HTMLDialogElement"in window?"dialog":"div")).classList.add(B.overlay),e.content=document.createElement("div"),e.content.classList.add(B.content),e.appendChild(e.content)),e.buttons={},D=function(){if(null==d)return null;var t=e.querySelector(d);if(!t){var n=d.substr(1);if(t=document.createElement("div"),"#"===d.charAt(0))t.id=n;else{if("."!==d.charAt(0))throw new Error("buttonContainerSelector must be a class or an ID. Complex selector given.");t.classList.add(n)}F.toUpperCase()===BUTTON_CONTAINER_PLACEMENT_POLICY.OUTSIDE_CONTENT?e.appendChild(t):F.toUpperCase()===BUTTON_CONTAINER_PLACEMENT_POLICY.INSIDE_CONTENT&&e.content.appendChild(t)}return t}();var t=!0,n=!1,r=void 0;try{for(var o,a=E[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var l=o.value,c=e.querySelector(g[l]);c||((c=document.createElement("button")).classList.add(Y[l]),c.innerHTML=p[l],null===D?e.appendChild(c):k.toUpperCase()===BUTTON_PLACEMENT_POLICY.ALL?D.appendChild(c):k.toUpperCase()===BUTTON_PLACEMENT_POLICY.NAVIGATORS_ONLY?"close"!==l?D.appendChild(c):e.appendChild(c):k.toUpperCase()===BUTTON_PLACEMENT_POLICY.CLOSE_ONLY&&("close"===l?D.appendChild(c):e.appendChild(c))),e.buttons[l]=c}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e.getContent=function(){return e.content.querySelector("img, video, object, embed, iframe")},H=e,i.appendChild(H),H}return null}function getFigureIndex(e){return Array.prototype.indexOf.call(z,e)}function setCurrentFigure(e){null!=j&&j.classList.remove(U),e.classList.add(U),j=e}function updateOverlayFigure(){var e=j.cloneNode(!0);if(i.classList.add(R),W){"HTMLDialogElement"in window&&W instanceof HTMLDialogElement?W.open||W.showModal():W.classList.add(R);var t=W.content.querySelector("figure");t?W.content.replaceChild(e,t):W.content.firstChild?W.content.insertBefore(e,W.content.firstChild):W.content.appendChild(e),setContentSize()}}function navigateOverlayFigure(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;setCurrentFigure(z[keepInBound(getFigureIndex(j)+e,t)]),x.isOpen()&&updateOverlayFigure()}function createButtonsCallbacks(){if(W){for(var e={},t=Object.keys(W.buttons),n=function _loop(){var n=t[i];e[n]=function(e){e.stopImmediatePropagation(),x[n]()}},i=0;i<t.length;i++)n();return e}return null}var G=function setListenersFn(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(L){if(i.addEventListener("click",Z.containerClick,!1),!e&&V||z.forEach(function(e){e.addEventListener("click",Z.figureClick,!1)}),W&&W.addEventListener("click",Z.dialogClick,!1),document.addEventListener("keydown",Z.keyboardNavigation),q&&(q.attach(),document.addEventListener("swipe",Z.swipeNavigation)),window.addEventListener("resize",Z.resize),W){Z.buttons||(Z.buttons=createButtonsCallbacks());for(var t=Object.keys(W.buttons),n=0;n<t.length;n++){var r=t[n];W.buttons[r].addEventListener("click",Z.buttons[r],!1)}}}else if(i.removeEventListener("click",Z.containerClick,!1),W&&W.removeEventListener("click",Z.dialogClick,!1),z.forEach(function(e){e.removeEventListener("click",Z.figureClick,!1)}),document.removeEventListener("keydown",Z.keyboardNavigation),q&&(q.detach(),document.removeEventListener("swipe",Z.swipeNavigation)),window.removeEventListener("resize",Z.resize),W)for(var o=Object.keys(W.buttons),a=0;a<o.length;a++){var l=o[a];W.buttons[l].removeEventListener("click",Z.buttons[l],!1)}return setListenersFn}(!0),V=function(){if("MutationObserver"in window){var e=new MutationObserver(function(e){e.forEach(function(e){"childList"===e.type&&(z=i.querySelectorAll("figure"),e.addedNodes&&e.addedNodes.length>0&&e.addedNodes.forEach(function(e){"FIGURE"===e.tagName&&e.addEventListener("click",Z.figureClick,!1)}),e.removedNodes&&j in e.removedNodes.values()&&(j=z[0]||null))})});return e.observe(i,{childList:!0}),e}return null}();this.open=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(null==t)t=getFigureIndex(j);else if(t=parseInt(t),I){if(t>z.length-1||Math.abs(t)>z.length-1)throw new Error("The element #".concat(t," cannot be found."))}else t=keepInBound(t);x.isOpen()&&z[t]===j||((z.length>0||t<=z.length||null==j)&&setCurrentFigure(z[0]),null!=j&&updateOverlayFigure());var n=null;return"function"!=typeof window.CustomEvent?(n=document.createEvent("fig-gallery:opened")).initCustomEvent("fig-gallery:opened",!1,!1,{current:j,active:x.getActiveFigure()}):n=new CustomEvent("fig-gallery:opened",{detail:{current:j,active:x.getActiveFigure()}}),i.dispatchEvent(n),e},this.prev=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,n=j;navigateOverlayFigure(-1,t);var r=null;return"function"!=typeof window.CustomEvent?(r=document.createEvent("fig-gallery:prev")).initCustomEvent("fig-gallery:prev",!1,!1,{current:j,next:n,active:x.getActiveFigure()}):r=new CustomEvent("fig-gallery:prev",{detail:{current:j,next:n,active:x.getActiveFigure()}}),i.dispatchEvent(r),e},this.next=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,n=j;navigateOverlayFigure(1,t);var r=null;return"function"!=typeof window.CustomEvent?(r=document.createEvent("fig-gallery:next")).initCustomEvent("fig-gallery:next",!1,!1,{current:j,prev:n,active:x.getActiveFigure()}):r=new CustomEvent("fig-gallery:next",{detail:{current:j,prev:n,active:x.getActiveFigure()}}),i.dispatchEvent(r),e},this.set=function(t){if(null==t)throw new Error("The given element is not a valid value. Please, insert an integer or a DOM element.");if("number"==typeof t){if(I){if(t>z.length-1||Math.abs(t)>z.length-1)throw new Error("The element #".concat(t," cannot be found."))}else t=keepInBound(t);t=z[t]}else{if(!(t instanceof HTMLElement))throw new Error("The given element is not a valid value. Please, insert an integer or a DOM element.");if(getFigureIndex(t)<0)throw new Error("The given element is not in this gallery.")}var n=j;setCurrentFigure(t),updateOverlayFigure();var r=null;return"function"!=typeof window.CustomEvent?(r=document.createEvent("fig-gallery:setted")).initCustomEvent("fig-gallery:setted",!1,!1,{current:j,old:n,active:x.getActiveFigure()}):r=new CustomEvent("fig-gallery:setted",{detail:{current:j,old:n,active:x.getActiveFigure()}}),i.dispatchEvent(r),e},this.close=function(){W&&("HTMLDialogElement"in window&&W instanceof HTMLDialogElement?W.open&&W.close():W.classList.remove(R)),i.classList.remove(R);var t=null;return"function"!=typeof window.CustomEvent?(t=document.createEvent("fig-gallery:closed")).initCustomEvent("fig-gallery:closed",!1,!1,{current:j}):t=new CustomEvent("fig-gallery:closed",{detail:{current:j}}),i.dispatchEvent(t),e},this.setOpenable=function(t){if(!t||"boolean"!=typeof t)throw new Error("The value must be a boolean.");if(t!==L){L=t,t?(W=createOverlay(),V&&V.observe(i,{childList:!0})):(W=null,V&&V.disconnect(),W&&i.removeChild(W)),G();var n=null;"function"!=typeof window.CustomEvent?(n=document.createEvent("fig-gallery:openablechange")).initCustomEvent("fig-gallery:openablechange",!1,!1,{openable:t}):n=new CustomEvent("fig-gallery:openablechange",{detail:{openable:t}}),i.dispatchEvent(n)}return e},this.updateFigures=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return z=i.querySelectorAll("figure"),t&&z.forEach(function(e){e.addEventListener("click",Z.figureClick,!1)}),j in z||(j=z[0]||null),e},this.isOpen=function(){return i.classList.contains(R)},this.isOpenable=function(){return L},this.getContainer=function(){return i},this.getControlsContainer=function(){return D},this.getCurrentFigure=function(){return j},this.getActiveFigure=function(){return W?W.content.querySelector("figure"):null},this.getActiveContent=function(){return W?W.getContent():null},this.getSwipeHandler=function(){return q}}window.BUTTON_CONTAINER_PLACEMENT_POLICY={OUTSIDE_CONTENT:"OUTSIDE_CONTENT",INSIDE_CONTENT:"INSIDE_CONTENT"},Object.freeze(window.BUTTON_CONTAINER_PLACEMENT_POLICY),window.BUTTON_PLACEMENT_POLICY={ALL:"ALL",NAVIGATORS_ONLY:"NAVIGATORS_ONLY",CLOSE_ONLY:"CLOSE_ONLY"},Object.freeze(window.BUTTON_PLACEMENT_POLICY),window.RESIZE_POLICY={CONTENT:"CONTENT",CONTAINER:"CONTAINER"},Object.freeze(window.RESIZE_POLICY);
//# sourceMappingURL=fig-gallery.js.map
